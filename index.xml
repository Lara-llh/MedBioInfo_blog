<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>MedBioInfo Applied Bioinformatics blog by Lara</title>
<link>https://Lara-llh.github.io/MedBioInfo_blog/</link>
<atom:link href="https://Lara-llh.github.io/MedBioInfo_blog/index.xml" rel="self" type="application/rss+xml"/>
<description>A blog built with Quarto</description>
<generator>quarto-1.8.25</generator>
<lastBuildDate>Fri, 10 Oct 2025 00:00:00 GMT</lastBuildDate>
<item>
  <title>Visualize your data with ggplot</title>
  <dc:creator>Lara Leal</dc:creator>
  <link>https://Lara-llh.github.io/MedBioInfo_blog/posts/ggplot/</link>
  <description><![CDATA[ 






<p>After you have finished your downstream analyses, you will want to visualize your results.</p>
<p><code>R</code> has a powefull package, called <a href="https://ggplot2.tidyverse.org">ggplot</a> that is very versatile. We work with it a lot, so we will present it to you today.</p>
<p>In order to understand better the possibilities of ggplot, we are going to try them out in this <a href="https://nbisweden.github.io/raukr-2023/labs/ggplot/">tutorial</a> from Roy Francis at NBIS.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dplyr"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidyr"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"stringr"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggplot2"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggrepel"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"patchwork"</span>))</span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyr)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(stringr)</span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb1-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggrepel)</span>
<span id="cb1-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(patchwork)</span>
<span id="cb1-10"></span>
<span id="cb1-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"iris"</span>)</span>
<span id="cb1-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(iris)</span>
<span id="cb1-13"></span>
<span id="cb1-14"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>iris)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>Petal.Length,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>Petal.Width)) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#basic scatter plot</span></span>
<span id="cb1-16"></span>
<span id="cb1-17"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>iris,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>Petal.Length,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>Petal.Width))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#add a regression line</span></span>
<span id="cb1-20"></span>
<span id="cb1-21"></span>
<span id="cb1-22"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>iris,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>Petal.Length,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>Petal.Width,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span>Species))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#add colours</span></span>
<span id="cb1-25"></span>
<span id="cb1-26"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>iris,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>Petal.Length,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>Petal.Width))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span>Species))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#add colours but keep only one regression line</span></span>
<span id="cb1-29"></span>
<span id="cb1-30"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>iris,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>Petal.Length,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>Petal.Width))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span>Species),<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#change the size of the points</span></span>
<span id="cb1-33"></span>
<span id="cb1-34"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>iris,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>Petal.Length,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>Petal.Width))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span>Species,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span>Sepal.Width))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#add another subgoup, in this case the sepal.width</span></span>
<span id="cb1-37"></span>
<span id="cb1-38"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>iris,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>Petal.Length,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>Petal.Width))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span>Species,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span>Sepal.Width))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"green"</span>)) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#specify colours</span></span>
<span id="cb1-42"></span>
<span id="cb1-43"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>iris,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>Petal.Length,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>Petal.Width))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span>Sepal.Width))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#map the colours to a continous variable</span></span>
<span id="cb1-46"></span>
<span id="cb1-47"></span>
<span id="cb1-48"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>iris,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>Petal.Length,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>Petal.Width))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-49">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span>Sepal.Width))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-50">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-51">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"New Legend Title"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-52">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"This Is A Title"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"This is a subtitle"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" Petal Length"</span>, </span>
<span id="cb1-53">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Petal Width"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"This is a little caption."</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#add titles</span></span>
<span id="cb1-54"></span>
<span id="cb1-55"></span>
<span id="cb1-56"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>iris,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>Petal.Length,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>Petal.Width))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-57">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span>Sepal.Width))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-58">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-59">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"New Legend Title"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-60">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-61">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"This Is A Title"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"This is a subtitle"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" Petal Length"</span>, </span>
<span id="cb1-62">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Petal Width"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"This is a little caption."</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#modify the axis, start with 1,2,3</span></span>
<span id="cb1-63"></span>
<span id="cb1-64"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>iris,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>Petal.Length,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>Petal.Width))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-65">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span>Sepal.Width))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-66">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-67">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"New Legend Title"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-68">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-69">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"This Is A Title"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"This is a subtitle"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" Petal Length"</span>, </span>
<span id="cb1-70">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Petal Width"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"This is a little caption."</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-71">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>Species) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#create subplots using faceting function</span></span>
<span id="cb1-72"></span>
<span id="cb1-73"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>iris,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>Petal.Length,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>Petal.Width))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-74">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span>Sepal.Width))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-75">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-76">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"New Legend Title"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-77">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-78">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"This Is A Title"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"This is a subtitle"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" Petal Length"</span>, </span>
<span id="cb1-79">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Petal Width"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"This is a little caption."</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-80">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>Species)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-81">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>() <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#change the look of the plot by using the default theme_bw option</span></span>
<span id="cb1-82"></span>
<span id="cb1-83"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>iris,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>Petal.Length,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>Petal.Width))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-84">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span>Sepal.Width))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-85">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-86">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"New Legend Title"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-87">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-88">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"This Is A Title"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"This is a subtitle"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" Petal Length"</span>, </span>
<span id="cb1-89">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Petal Width"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"This is a little caption."</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-90">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>Species)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-91">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-92">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb1-93">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Blue"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>),</span>
<span id="cb1-94">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Green"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>),</span>
<span id="cb1-95">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Pink"</span>),</span>
<span id="cb1-96">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>()</span>
<span id="cb1-97">  ) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#use the theme to chnage the colours of the axis and title/subtitle</span></span>
<span id="cb1-98"></span>
<span id="cb1-99"></span>
<span id="cb1-100">newtheme <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb1-101">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightblue1"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>),</span>
<span id="cb1-102">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"khaki4"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>),</span>
<span id="cb1-103">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lavender"</span>),</span>
<span id="cb1-104">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>()) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#this will save the theme and afterwards this same theme can be reused</span></span>
<span id="cb1-105"></span>
<span id="cb1-106"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>iris,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>Petal.Length,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>Petal.Width))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-107">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span>Sepal.Width))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-108">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-109">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"New Legend Title"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-110">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-111">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"This Is A Title"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"This is a subtitle"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" Petal Length"</span>, </span>
<span id="cb1-112">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Petal Width"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"This is a little caption."</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-113">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>Species)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-114">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-115">  newtheme</span>
<span id="cb1-116"></span>
<span id="cb1-117"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>iris,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>Petal.Length,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>Petal.Width))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-118">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span>Species,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span>Sepal.Width)) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#it shows 2 legends</span></span>
<span id="cb1-119"></span>
<span id="cb1-120"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>iris,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>Petal.Length,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>Petal.Width))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-121">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span>Species,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span>Sepal.Width))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-122">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#we removed one legend</span></span>
<span id="cb1-123"></span>
<span id="cb1-124"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>iris,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>Petal.Length,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>Petal.Width))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-125">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span>Species,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span>Sepal.Width),<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.legend=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#turning off both legends using geom</span></span>
<span id="cb1-126"></span>
<span id="cb1-127"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>iris,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>Petal.Length,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>Petal.Width))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-128">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span>Species,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span>Sepal.Width))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-129">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span>,</span>
<span id="cb1-130">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.justification=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#use theme to move the position of the legends</span></span>
<span id="cb1-131"></span>
<span id="cb1-132"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>iris,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>Petal.Length,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>Petal.Width))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-133">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span>Species,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span>Sepal.Width))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-134">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guide_legend</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">byrow=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb1-135">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guide_legend</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">byrow=</span>T))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-136">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span>,</span>
<span id="cb1-137">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.justification=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#control of the legends rows</span></span>
<span id="cb1-138"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>iris,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>Petal.Length,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>Petal.Width))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-139">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span>Species))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-140">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label=</span>Species,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nudge_x=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add labels to the data/points</span></span>
<span id="cb1-141"></span>
<span id="cb1-142"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>iris,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>Petal.Length,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>Petal.Width))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-143">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span>Species))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-144">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_label</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label=</span>Species,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nudge_x=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#edit the labels theme</span></span>
<span id="cb1-145"></span>
<span id="cb1-146"></span>
<span id="cb1-147"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggrepel)</span>
<span id="cb1-148"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>iris,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>Petal.Length,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>Petal.Width))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-149">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span>Species))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-150">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text_repel</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label=</span>Species),<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#use ggrepel to avoid having the labels overlapping</span></span>
<span id="cb1-151"></span>
<span id="cb1-152"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>iris,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>Petal.Length,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>Petal.Width))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-153">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span>Species))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-154">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.1</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"There is a random line here"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-155">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"segment"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#add customn annotations</span></span>
<span id="cb1-156"></span>
<span id="cb1-157"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>iris,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>Species,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>Petal.Width))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-158">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#BARPLOT</span></span>
<span id="cb1-159"></span>
<span id="cb1-160"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>iris,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>Species,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>Petal.Width))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-161">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-162">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_flip</span>() <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#flip the axes</span></span>
<span id="cb1-163"></span>
<span id="cb1-164">dfr <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> iris <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(Species) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-165">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(Sepal.Length),<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(Sepal.Length)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-166">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">high=</span>mean<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>sd,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">low=</span>mean<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>sd) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#mean and standard deviation </span></span>
<span id="cb1-167"></span>
<span id="cb1-168"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>dfr,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>Species,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>mean,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span>Species))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-169">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-170">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_errorbar</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax=</span>high,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin=</span>low),<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#plotting the error bars</span></span>
<span id="cb1-171"></span>
<span id="cb1-172"></span>
<span id="cb1-173"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">###### ECONOMIST SCATTERPLOT #######</span></span>
<span id="cb1-174"></span>
<span id="cb1-175">ec <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/Users/lara/Downloads/data_economist.csv"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">header=</span>T) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#import the data from the .csv file</span></span>
<span id="cb1-176"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(ec) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#read the data</span></span>
<span id="cb1-177"></span>
<span id="cb1-178"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(ec) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#check that HDI and CPI are numerical variables and Region is a categorical one/factor</span></span>
<span id="cb1-179"></span>
<span id="cb1-180"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(ec<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Region) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># we can't see the levels, therefore we need to modify the Regions variable</span></span>
<span id="cb1-181"></span>
<span id="cb1-182">ec<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Region <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(ec<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Region,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EU W. Europe"</span>,</span>
<span id="cb1-183">                                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Americas"</span>,</span>
<span id="cb1-184">                                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Asia Pacific"</span>,</span>
<span id="cb1-185">                                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"East EU Cemt Asia"</span>,</span>
<span id="cb1-186">                                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MENA"</span>,</span>
<span id="cb1-187">                                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SSA"</span>),</span>
<span id="cb1-188">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OECD"</span>,</span>
<span id="cb1-189">                               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Americas"</span>,</span>
<span id="cb1-190">                               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Asia &amp;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Oceania"</span>,</span>
<span id="cb1-191">                               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Central &amp;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Eastern Europe"</span>,</span>
<span id="cb1-192">                               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Middle East &amp;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">North Africa"</span>,</span>
<span id="cb1-193">                               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sub-Saharan</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Africa"</span>)) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#use factor levels and labels to rename factors</span></span>
<span id="cb1-194"></span>
<span id="cb1-195"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(ec<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Region) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#check that we have made the change</span></span>
<span id="cb1-196"></span>
<span id="cb1-197"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(ec,<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>CPI,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>HDI,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span>Region))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-198">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stroke=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#generate a plot with points without fill. </span></span>
<span id="cb1-199"></span>
<span id="cb1-200"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(ec,<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>CPI,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>HDI,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span>Region))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-201">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stroke=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-202">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula=</span>y<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">poly</span>(x,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">se=</span>F,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#add a trendline in red</span></span>
<span id="cb1-203"></span>
<span id="cb1-204">p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(ec,<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>CPI,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>HDI,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span>Region))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-205">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>),<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula=</span>y<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">poly</span>(x,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">se=</span>F,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-206">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stroke=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#we want the points on top of the line so we assign the plot to a variable and alter the order of geom_smooth and geom_point</span></span>
<span id="cb1-207">p <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#to print/see the plot</span></span>
<span id="cb1-208"></span>
<span id="cb1-209">labels <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Congo"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Afghanistan"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sudan"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Myanmar"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Iraq"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Venezuela"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Russia"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Argentina"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Brazil"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Italy"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"South Africa"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cape Verde"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Bhutan"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Botswana"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Britian"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"New Zealand"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Greece"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"China"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"India"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rwanda"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Spain"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"France"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"United States"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Japan"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Norway"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Singapore"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Barbados"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Germany"</span>)</span>
<span id="cb1-210"></span>
<span id="cb1-211">p<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">subset</span>(ec,Country <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> labels),<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label=</span>Country),<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#add the labels to the new coutries on the plot</span></span>
<span id="cb1-212"></span>
<span id="cb1-213"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">########</span></span>
<span id="cb1-214"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#IF YOU WAN TO CHANGE THE FONT </span></span>
<span id="cb1-215"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(extrafont)</span>
<span id="cb1-216"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(extrafont)</span>
<span id="cb1-217"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_import</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Georgia"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prompt=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb1-218"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># load fonts for pdf</span></span>
<span id="cb1-219"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">loadfonts</span>()</span>
<span id="cb1-220"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># list available fonts in R</span></span>
<span id="cb1-221"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fonts</span>()</span>
<span id="cb1-222"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">########</span></span>
<span id="cb1-223"></span>
<span id="cb1-224">p<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">subset</span>(ec,Country <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> labels),<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label=</span>Country),</span>
<span id="cb1-225">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Georgia"</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#change the font of the labels</span></span>
<span id="cb1-226"></span>
<span id="cb1-227"></span>
<span id="cb1-228"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggrepel)</span>
<span id="cb1-229">p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> p<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text_repel</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">subset</span>(ec,Country <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> labels),<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label=</span>Country),</span>
<span id="cb1-230">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">box.padding=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'lines'</span>),<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.size=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>,</span>
<span id="cb1-231">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Georgia"</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#solve the overlap of the labels</span></span>
<span id="cb1-232">p</span>
<span id="cb1-233"></span>
<span id="cb1-234">p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> p<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Corruption Perceptions Index, 2011 (10=least corrupt)"</span>,</span>
<span id="cb1-235">                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-236">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Human Development Index, 2011 (1=best)"</span>,</span>
<span id="cb1-237">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">from=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">to=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>),<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#adjust the axes</span></span>
<span id="cb1-238">p</span>
<span id="cb1-239"></span>
<span id="cb1-240">p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> p<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#23576E"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#099FDB"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#29B00E"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#208F84"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#F55840"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#924F3E"</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-241">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"trend"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expression</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(R<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"=52%"</span>))) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#to change the colors of the points and the red fill label </span></span>
<span id="cb1-242">p</span>
<span id="cb1-243"></span>
<span id="cb1-244"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#I don't want to change the colors so I'm just going to add the new label</span></span>
<span id="cb1-245">p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> p<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"trend"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expression</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(R<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"=52%"</span>)))</span>
<span id="cb1-246">p</span>
<span id="cb1-247"></span>
<span id="cb1-248">p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> p<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Corruption and human development"</span>,</span>
<span id="cb1-249">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sources: Transparency International; UN Human Development Report"</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#add a title to the plot </span></span>
<span id="cb1-250">p</span>
<span id="cb1-251"></span>
<span id="cb1-252">p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> p<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guide_legend</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-253">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Georgia"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-254">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#move the legend to the top and change the font in all the text</span></span>
<span id="cb1-255">p</span>
<span id="cb1-256"></span>
<span id="cb1-257"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">### Now we do some careful refining with themes.</span></span>
<span id="cb1-258"></span>
<span id="cb1-259"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Turn off minor gridlines</span></span>
<span id="cb1-260"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Turn off major gridlines on x-axis</span></span>
<span id="cb1-261"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Remove the gray background</span></span>
<span id="cb1-262"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Remove panel border</span></span>
<span id="cb1-263"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Remove legend titles</span></span>
<span id="cb1-264"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Make axes titles italic</span></span>
<span id="cb1-265"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Turn off y-axis ticks</span></span>
<span id="cb1-266"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Change x-axis ticks to color grey60</span></span>
<span id="cb1-267"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Make plot title bold</span></span>
<span id="cb1-268"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Decrease size of caption to size 8</span></span>
<span id="cb1-269"></span>
<span id="cb1-270">p<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.minor=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb1-271">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major.x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb1-272">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.background=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb1-273">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.border=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb1-274">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb1-275">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"italic"</span>),</span>
<span id="cb1-276">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb1-277">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey60"</span>),</span>
<span id="cb1-278">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>),</span>
<span id="cb1-279">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>))</span>
<span id="cb1-280"></span>
<span id="cb1-281"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sessionInfo</span>()</span></code></pre></div></div>



 ]]></description>
  <guid>https://Lara-llh.github.io/MedBioInfo_blog/posts/ggplot/</guid>
  <pubDate>Fri, 10 Oct 2025 00:00:00 GMT</pubDate>
  <media:content url="https://Lara-llh.github.io/MedBioInfo_blog/posts/ggplot/logo_ggplot.png" medium="image" type="image/png" height="166" width="144"/>
</item>
<item>
  <title>Nf-Core</title>
  <dc:creator>Lara Leal</dc:creator>
  <link>https://Lara-llh.github.io/MedBioInfo_blog/posts/Nf-core_RNAseq_pipeline/</link>
  <description><![CDATA[ 






<p><img src="https://Lara-llh.github.io/MedBioInfo_blog/posts/Nf-core_RNAseq_pipeline/nf-core-rnaseq_metro_map_grey_animated.svg" class="img-fluid"></p>
<p>Now that we have tested nextflow and nf-core, we want to use the pipeline in our own data.</p>
<section id="pixi-environment" class="level2">
<h2 class="anchored" data-anchor-id="pixi-environment"><strong>1. Pixi environment</strong></h2>
<p>First, we need to make a new directory for the analysis. What dependencies do we need for Nextflow and nf-core? Our <code>pixi.toml</code> file should look like this:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[workspace]</span></span>
<span id="cb1-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">channels</span> = [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"conda-forge"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bioconda"</span>]</span>
<span id="cb1-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">name</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nf-core_RNAseq"</span></span>
<span id="cb1-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">platforms</span> = <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"linux-64"</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb1-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">version</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.1.0"</span></span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[tasks]</span></span>
<span id="cb1-8"></span>
<span id="cb1-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[dependencies]</span></span>
<span id="cb1-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">nf-core</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&gt;=3.3.2,&lt;4"</span></span>
<span id="cb1-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">nextflow</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&gt;=25.4.8,&lt;26"</span></span></code></pre></div></div>
</section>
<section id="link-your-data-into-the-directory" class="level2">
<h2 class="anchored" data-anchor-id="link-your-data-into-the-directory"><strong>2. Link your data into the directory</strong></h2>
<p>Make a subdirectory, <code>data</code>, change into it and create a symlink to the data:</p>
<p>Use:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ln</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span> SOURCE TARGET</span></code></pre></div></div>
<p>Since you are in the directory <code>data</code> the TARGET is simply <code>.</code> .</p>
<p>Change back to the parent directory.</p>
</section>
<section id="nf-core-launch" class="level2">
<h2 class="anchored" data-anchor-id="nf-core-launch"><strong>3. nf-core launch</strong></h2>
<p>The nf-core platform helps you set up the pipleines with the <code>nf-core launcher</code>. In order to use it, you have to go to the nf-core webpage of the pipleine you are interested in. In this case, we are going to use the <a href="https://nf-co.re/rnaseq/3.19.0/">nf-core/rnaseq</a>, following this link you have to click on the button <code>launch version 3.19.0</code>(it could be a different one in the future). We are then redirected to a page where we can fill in all of our information about input files, as well as selecting or deselecting certain parts of the pipeline.</p>
<section id="setting-working-and-results-directories" class="level3">
<h3 class="anchored" data-anchor-id="setting-working-and-results-directories"><strong>Setting working and results directories</strong></h3>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>We recommend that you use absolute paths rather than relative paths for setting up your runs.</p>
</div>
</div>
</div>
<p>During the first part, you need to set a working and result directory. If you are using a server that has a profile established, you can put the name of the server there. In our case, we will use the server configuration file locally.</p>
<p>Set resume to True, otherwise you dont need to change anything here. <img src="https://Lara-llh.github.io/MedBioInfo_blog/posts/Nf-core_RNAseq_pipeline/nextflow_command-line_flags.png" class="img-fluid"></p>
<p>Next, the pipeline asks for the input CSV. Exact requirements for how that input file should look like can be found under the tab Usage on the pipeline homepage. This input CSV is unique to each analysis. The input CSV (<code>samplesheet.csv</code>) we need for this pipeline looks like this:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sample,fastq_1,fastq_2,strandedness</span></span>
<span id="cb3-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">SRR5223504,</span> /proj/nobackup/medbioinfo2025/lara_leal/nf-core_test_course/nf-core_RNAseq/data/SRR5223504_1.fastq.gz, /proj/nobackup/medbioinfo2025/lara_leal/nf-core_test_course/nf-core_RNAseq/data/SRR5223504_2.fastq.gz, auto</span>
<span id="cb3-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">SRR5223517,</span> /proj/nobackup/medbioinfo2025/lara_leal/nf-core_test_course/nf-core_RNAseq/data/SRR5223517_1.fastq.gz, /proj/nobackup/medbioinfo2025/lara_leal/nf-core_test_course/nf-core_RNAseq/data/SRR5223517_2.fastq.gz, auto</span></code></pre></div></div>
<p><img src="https://Lara-llh.github.io/MedBioInfo_blog/posts/Nf-core_RNAseq_pipeline/input-output_options.png" class="img-fluid"></p>
<p>Set the outdir to the name and path to a directory you want the output to be saved to.</p>
</section>
<section id="setting-all-other-inputs-that-are-required" class="level3">
<h3 class="anchored" data-anchor-id="setting-all-other-inputs-that-are-required"><strong>Setting all other inputs that are required</strong></h3>
<p>In this section, you set variables that are related to your reference genome. If you are using something listed on iGenomes, you can input that name. If you are working with your own reference genome, or something not listed, you need to input the absolute path of the reference genomes you have downloaded. <img src="https://Lara-llh.github.io/MedBioInfo_blog/posts/Nf-core_RNAseq_pipeline/reference_genome_1.png" class="img-fluid"> <img src="https://Lara-llh.github.io/MedBioInfo_blog/posts/Nf-core_RNAseq_pipeline/reference_genome_2.png" class="img-fluid"></p>
<p>Depending on your strategy, you might need to input a corresponding gff as well. It really depends on the kind of analysis you are hoping to perform.</p>
<p>In our case, we have human samples, so in theory we can use the iGenomes reference. However, the transcriptome and GTF files in iGenomes are out of date, so nf-core recommends downloading and using the more up-to-date version. In order to do so we are going to follow <a href="https://nf-co.re/docs/usage/reference_genomes#custom-genomes">these instructions</a>. We are going to create a <code>reference</code> folder in our directory that is going to contain the downloaded genome and a <code>download.sh</code> file with the following information:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/bin/bash -l</span></span>
<span id="cb4-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH -A hpc2n2025-203</span></span>
<span id="cb4-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH -t 10:00</span></span>
<span id="cb4-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH -n 1</span></span>
<span id="cb4-5"> </span>
<span id="cb4-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">VERSION</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>108</span>
<span id="cb4-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-L</span> ftp://ftp.ensembl.org/pub/release-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$VERSION</span>/fasta/homo_sapiens/dna/Homo_sapiens.GRCh38.dna_sm.primary_assembly.fa.gz</span>
<span id="cb4-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-L</span> ftp://ftp.ensembl.org/pub/release-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$VERSION</span>/gtf/homo_sapiens/Homo_sapiens.GRCh38.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$VERSION</span>.gtf.gz</span></code></pre></div></div>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Other than the options above, you dont need to change anything to run the pipeline. However, for your project you might want to change some of the default parameters. For this exercise we will keep the rest as it is.</p>
</div>
</div>
</div>
</section>
<section id="getting-your-json-file" class="level3">
<h3 class="anchored" data-anchor-id="getting-your-json-file"><strong>Getting your JSON file</strong></h3>
<p>Once everything is filled in, click on Launch and you will be redirected to another page containing your JSON file that has information on your run.</p>
<p>Copy the JSON file a bit lower on the screen and saving it as <code>nf-params.json</code> in your folder on HPC2N.</p>
<p>Add the <code>save_reference</code> line as recommended by nf-core (because we are using their downloaded human genome). <img src="https://Lara-llh.github.io/MedBioInfo_blog/posts/Nf-core_RNAseq_pipeline/run_launch.png" class="img-fluid"></p>
</section>
<section id="configuration-profile" class="level3">
<h3 class="anchored" data-anchor-id="configuration-profile"><strong>Configuration profile</strong></h3>
<p>As before, you need the HPC2N configuration file, with the correct project ID.</p>
<p>Add your e-mail under <code>email</code> and you will receive a message with a summary of the run.</p>
</section>
</section>
<section id="starting-the-run" class="level2">
<h2 class="anchored" data-anchor-id="starting-the-run"><strong>4. Starting the run</strong></h2>
<p>The launcher gives us the command to run the pipeline:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">nextflow</span> run nf-core/rnaseq <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> 3.19.0 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-resume</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-params-file</span> nf-params.json</span></code></pre></div></div>
<p>We need to change this slightly, to add that we are running it via Pixi, and to add the server specific configuration file:</p>
<section id="submit-directly-via-pixi" class="level3">
<h3 class="anchored" data-anchor-id="submit-directly-via-pixi"><strong>Submit directly via pixi</strong></h3>
<p>Now you can run the pipeline with the following command (you might have to change it a bit to add pathways to files that are not in your current working directory):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pixi</span> run nextflow run nf-core/rnaseq <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> 3.19.0 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-resume</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-params-file</span> nf-params.json <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> hpc2n.config</span></code></pre></div></div>
<p>There are several layers to this command:</p>
<p>First we invoke <code>Pixi</code> and tell it to run the following commands.</p>
<p>Then we say which program we want to run, namely <code>Nextflow</code>.</p>
<p>The following commands are Nextflow/ nf-core commands:</p>
<ul>
<li>we want to run the nf-core/rnaseq pipeline, version 3.19.0</li>
<li>we want to use the parameter file called nf-params.json</li>
<li>we want to use the hpc configuration file called hpc2n.config</li>
</ul>
</section>
<section id="submit-via-sbatch" class="level3">
<h3 class="anchored" data-anchor-id="submit-via-sbatch"><strong>Submit via sbatch</strong></h3>
<p>Alternatively, you can run nextflow via pixi using a batch script and slurm: copy the following text to file called <code>name_submit_rnaseq.sh</code> where name is your name.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/bin/bash -l</span></span>
<span id="cb7-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH -A our_proj_allocation</span></span>
<span id="cb7-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH -n 5</span></span>
<span id="cb7-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH -t 24:00:00</span></span>
<span id="cb7-5"></span>
<span id="cb7-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/your_home_directory/.pixi/bin/pixi</span> run nextflow run nf-core/rnaseq <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> 3.19.0 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-params-file</span> /your_path/nf-params.json <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> server.config</span></code></pre></div></div>
<p>And then submit it to slurm with:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sbatch</span> name_submit_rnaseq.sh</span></code></pre></div></div>
<p>You can check the progress of your job with squeue -u your_username</p>
<p>And now we wait until the run is done!</p>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Nextflow is notoriously bad at cleaning after itself. You can check previous runs with <code>pixi run nextflow log</code>. And then clean up with for example <code>pixi run nextflow clean -f -before &lt;run_name&gt;</code>.</p>
</div>
</div>
</div>


</section>
</section>

 ]]></description>
  <category>info</category>
  <category>code</category>
  <guid>https://Lara-llh.github.io/MedBioInfo_blog/posts/Nf-core_RNAseq_pipeline/</guid>
  <pubDate>Fri, 10 Oct 2025 00:00:00 GMT</pubDate>
  <media:content url="https://Lara-llh.github.io/MedBioInfo_blog/posts/Nf-core_RNAseq_pipeline/Nf-core RNAseq.png" medium="image" type="image/png" height="56" width="144"/>
</item>
<item>
  <title>Nf-Core</title>
  <dc:creator>Lara Leal</dc:creator>
  <link>https://Lara-llh.github.io/MedBioInfo_blog/posts/Nf-core/</link>
  <description><![CDATA[ 






<p><img src="https://Lara-llh.github.io/MedBioInfo_blog/posts/Nf-core/nf-core-logo_big.png" class="post-header img-fluid"></p>
<p><a href="https://nf-co.re">Nf-core</a> is a very active community around nextflow. All nf-core pipelines are open source and the source code is available on github. The pipelines are developed by volunteers, who can have a very varied background.</p>
<p>While nf-core is fantastic, please be aware that their pipelines are developed and maintained (or not maintained) by the community. You should not use the pipelines as a black box, but as a tool you need to understand. The responsibility for the end results is still yours, so you need to see if your data is suited for the analysis (good enough quality?), and if the analysis is suitable for your data!</p>
<section id="why-can-these-pipelines-be-interesting-for-you" class="level2">
<h2 class="anchored" data-anchor-id="why-can-these-pipelines-be-interesting-for-you"><strong>Why can these pipelines be interesting for you?</strong></h2>
<p>Nf-core provides already developed pipelines for many different data sets. Likely, a pipelines exists that you can use on your data. The documentation of the pipelines follows nf-core guidelines and is extensive and informative - it is easy to understand what the pipeline does and how it works. All output is explained in detail, with links to more extensive documentation.</p>
<p>Once you have understood how to run a nf-core pipeline their consistency and standardization means you will know most about running a different one.</p>
<p>Using the nf-core launcher, will check your input, and automatically generate commands and configuration files.</p>
<p>And this is on top of all nextflow functionality such as portability, reproducibility and the resume-at-fault option!</p>
</section>
<section id="nf-core-test-pipeline" class="level2">
<h2 class="anchored" data-anchor-id="nf-core-test-pipeline"><strong>nf-core: test pipeline</strong></h2>
<p>In this section, we will create a pixi environment containing nf-core and nextflow. Once weve done that, we will turn our attention to nf-core to run up a pipeline with the build in test data. This is a good way to test the setup, and to familiarize yourself with the output of the pipeline.</p>
<section id="set-up-your-pixi-environment" class="level3">
<h3 class="anchored" data-anchor-id="set-up-your-pixi-environment"><strong>Set up your Pixi environment</strong></h3>
<p>In the course directory initialize an environment using the following command:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pixi</span> init nextflow_test <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> conda-forge <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> bioconda</span></code></pre></div></div>
<p>Change directory into the project you created, and list the files there:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> name_nextflow</span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span></span></code></pre></div></div>
<p>Add nf-core and Nextflow:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pixi</span> add nextflow nf-core</span></code></pre></div></div>
<p>And just check that everything worked, check the version of nextflow, get the nf-core help, and run the nextflow Hello World:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pixi</span> run nextflow <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-version</span></span>
<span id="cb4-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pixi</span> run nf-core <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--help</span></span>
<span id="cb4-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pixi</span> run nextflow run hello</span></code></pre></div></div>
<p>While apptainer is sticky loaded on this server, it wont always be the case for other servers. So, if you are running within a Linux environment (and not otherwise), you can add apptainer with the add command.</p>
</section>
<section id="configuration-profile" class="level3">
<h3 class="anchored" data-anchor-id="configuration-profile"><strong>Configuration profile</strong></h3>
<p>Since we are working on a server with a configuration profile established, but not available via nf-core, you need to download it to your working directory:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> https://raw.githubusercontent.com/hpc2n/intro-course/master/exercises/NEXTFLOW/INTERACTIVE/hpc2n.config</span></code></pre></div></div>
<p>Here is the configuration profile on HPC2N from the above link. The most important things we need to pay attention to are the <code>max_memory</code>, <code>max_cpus</code>, and <code>max_time</code> settings. Your jobs wont be able to exceed these maximum values.</p>
<p>To use the config file with nextflow you need to add our compute project under project. Use single quotes, as seen in the other entries in the file.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">//</span> Config profile for HPC2N</span>
<span id="cb6-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params</span> {</span>
<span id="cb6-3">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">config_profile_description</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Cluster profile for HPC2N'</span></span>
<span id="cb6-4">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">config_profile_contact</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'----'</span></span>
<span id="cb6-5">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">config_profile_url</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'https://www.hpc2n.umu.se/'</span></span>
<span id="cb6-6">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">project</span> = null</span>
<span id="cb6-7">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">clusterOptions</span> = null</span>
<span id="cb6-8">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">max_memory</span> = 128.GB</span>
<span id="cb6-9">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">max_cpus</span> = 28</span>
<span id="cb6-10">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">max_time</span> = 168.h</span>
<span id="cb6-11">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">email</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'-----'</span></span>
<span id="cb6-12"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-13"></span>
<span id="cb6-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">singularity</span> {</span>
<span id="cb6-15">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">enabled</span> = true</span>
<span id="cb6-16"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-17"></span>
<span id="cb6-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">process</span> {</span>
<span id="cb6-19">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">executor</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'slurm'</span></span>
<span id="cb6-20">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">clusterOptions</span> = { <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-A </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$params</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.project </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${params</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">.clusterOptions ?: ''</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> }</span>
<span id="cb6-21"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div></div>
</section>
<section id="run-the-pipeline-with-a-test-profile" class="level3">
<h3 class="anchored" data-anchor-id="run-the-pipeline-with-a-test-profile"><strong>Run the pipeline with a test profile</strong></h3>
<p>As an example we willl run a <a href="https://nf-co.re/sarek/3.4.2/">Sarek pipeline</a>, which is a variant calling pipeline:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pixi</span> run nextflow run nf-core/sarek <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-profile</span> test <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--outdir</span> sarek_test <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> hpc2n.config</span></code></pre></div></div>
<p>Lets have a look at the components of the above command:</p>
<ul>
<li><code>pixi run</code>: we are using our pixi environment to run the following commands</li>
<li><code>nextflow run</code>: run the following with nextflow</li>
<li><code>nf-core/sarek</code>: name/ location of the pipeline</li>
<li><code>-profile test</code>: use the test profile for this run - this uses the build in test data etc. On servers with a nf-core configuration file you would list the name of the profile here.</li>
<li><code>--outdir sarek_test</code>: name and location of the directory for the pipeline output</li>
<li><code>-c hpc2n.config</code>: name and location of the configuration file for the server</li>
</ul>


</section>
</section>

 ]]></description>
  <category>info</category>
  <category>code</category>
  <guid>https://Lara-llh.github.io/MedBioInfo_blog/posts/Nf-core/</guid>
  <pubDate>Thu, 09 Oct 2025 00:00:00 GMT</pubDate>
  <media:content url="https://Lara-llh.github.io/MedBioInfo_blog/posts/Nf-core/nf-core_logo" medium="image"/>
</item>
<item>
  <title>Nextflow RNAseq pipeline</title>
  <dc:creator>Lara Leal</dc:creator>
  <link>https://Lara-llh.github.io/MedBioInfo_blog/posts/Nextflow_RNAseq_pipeline/</link>
  <description><![CDATA[ 






<p><img src="https://Lara-llh.github.io/MedBioInfo_blog/posts/Nextflow_RNAseq_pipeline/dna-7094409_1280.jpg" class="post-header img-fluid"></p>
<p>In a real-world biomedical example, we will implement a proof of concept workflow that:</p>
<ol type="1">
<li>Indexes the transcriptome file</li>
<li>Performs quality controls</li>
<li>Performs quantifications</li>
<li>Creates a MultiQC report</li>
</ol>
<p>In order to do so, 7 scripts will be used, an each of them builds upon the other. The scripts will use the following third-party tools:</p>
<ul>
<li>Salmon: tool for quantifing molecules known as transcripts through a type of data called RNA-seq.</li>
<li>FastQC: tool to perform control for high throughput sequence data, a way to assess the quality of your data.</li>
<li>MultiQC: searches a given directory for analysis logs and compiles a HTML report. Its a widely used tool, perfect for summarizing the output from numerous bioinformatics tools.</li>
</ul>
<section id="set-the-executor" class="level2">
<h2 class="anchored" data-anchor-id="set-the-executor"><strong>Set the executor</strong></h2>
<p>So far we have used the local executor, but the pipeline we are going to work with now is more complicated and requires more computing power. We will set <code>slurm</code> as the executor, in order to do so we will change it in a file called <code>nextflow.config</code>. It should loook like the following:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">process{</span></span>
<span id="cb1-2">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">executor</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"slurm"</span></span>
<span id="cb1-3">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">time</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'2.h'</span>  // Set default time limit for all processes</span>
<span id="cb1-4">    </span>
<span id="cb1-5">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">//</span> Other settings</span>
<span id="cb1-6">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">cpus</span> = 4</span>
<span id="cb1-7"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-8"></span>
<span id="cb1-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">resume</span> = true</span>
<span id="cb1-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">singularity.enabled</span> = true</span>
<span id="cb1-11"></span>
<span id="cb1-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">executor</span> {</span>
<span id="cb1-13">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">account</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'your_project_account'</span></span>
<span id="cb1-14"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div></div>
<p>With this script we:</p>
<ul>
<li>Set the executor for every process to slurm.</li>
<li>Set resume to true, so it is automatically used for all our runs (which means we do not have to specify this in our nextflow run command anymore).</li>
<li>Enable singularity and set some singularity run options.</li>
<li>Specify the account name for the slurm execution.</li>
</ul>
<p>This <code>nextflow.config</code> file is implicitly called when we execute nextflow from the folder it is in. We dont need to explicitily name it in the run command.</p>
</section>
<section id="define-the-workflow-parameters" class="level2">
<h2 class="anchored" data-anchor-id="define-the-workflow-parameters"><strong>Define the workflow parameters</strong></h2>
<p>Parameter are inputs and options that can be changed when the workflow is executed.</p>
<p>An example found in <code>script1.nf</code> of the training material is:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params.reads</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$projectDir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/data/ggal/gut_{1,2}.fq"</span></span>
<span id="cb2-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params.transcriptome_file</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$projectDir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/data/ggal/transcriptome.fa"</span></span>
<span id="cb2-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params.multiqc</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$projectDir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/multiqc"</span></span>
<span id="cb2-4"></span>
<span id="cb2-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">println</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reads: </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$params</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.reads"</span></span></code></pre></div></div>
<p>And it is run with the following command:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pixi</span> run nextflow run script1.nf</span></code></pre></div></div>
<p>Now we are going to modify the script adding a fourth parameter called <code>outdir</code> and we will set it to the default path that will be used as the workflow output directory.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/usr/bin/env nextflow</span></span>
<span id="cb4-2"></span>
<span id="cb4-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params.reads</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$projectDir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/data/ggal/gut_{1,2}.fq"</span></span>
<span id="cb4-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params.transcriptome_file</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$projectDir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/data/ggal/transcriptome.fa"</span></span>
<span id="cb4-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params.multiqc</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$projectDir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/multiqc"</span></span>
<span id="cb4-6"></span>
<span id="cb4-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params.outdir</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$projectDir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/results"</span></span>
<span id="cb4-8"></span>
<span id="cb4-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">println</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reads: </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$params</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.outdir"</span></span></code></pre></div></div>
</section>
<section id="create-a-transcriptome-index-file" class="level2">
<h2 class="anchored" data-anchor-id="create-a-transcriptome-index-file"><strong>Create a transcriptome index file</strong></h2>
<p>In Nextflow you can execute any command or script by using a <code>process definition</code>. A process is defined by providing 3 main declarations: the input, the output and the command script.</p>
<p>Lets add a transcriptome index processing step:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params.reads</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$projectDir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/data/ggal/gut_{1,2}.fq"</span></span>
<span id="cb5-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params.transcriptome_file</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$projectDir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/data/ggal/transcriptome.fa"</span></span>
<span id="cb5-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params.multiqc</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$projectDir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/multiqc"</span></span>
<span id="cb5-4"></span>
<span id="cb5-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params.outdir</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$projectDir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/results"</span></span>
<span id="cb5-6"></span>
<span id="cb5-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">println</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reads: </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$params</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.outdir"</span></span>
<span id="cb5-8"></span>
<span id="cb5-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">process</span> INDEX {</span>
<span id="cb5-10">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input:</span></span>
<span id="cb5-11">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">path</span> transcriptome</span>
<span id="cb5-12">    </span>
<span id="cb5-13">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">output:</span></span>
<span id="cb5-14">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">path</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'salmon_index'</span></span>
<span id="cb5-15"></span>
<span id="cb5-16">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">script:</span></span>
<span id="cb5-17">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb5-18"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    salmon index --threads </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$task</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.cpus -t </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$transcriptome</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> -i salmon_index</span></span>
<span id="cb5-19"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb5-20"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div></div>
<p>Additionally, we have to add a workflow scope containing an input channel definiton and the index process:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">workflow</span> {</span>
<span id="cb6-2">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">index_ch</span> = INDEX<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params.transcriptome_file,</span> checkIfExists: true<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">))</span></span>
<span id="cb6-3"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div></div>
<p>In this case the <code>params.transcriptome_file</code> parameter is used as the input for the index process. The index process (using salmon) creates salmon_index, an indexed transcriptome that is passed as an output to the index_ch channel.</p>
<p>To run it we will use:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pixi</span> run nextflow run script1.nf </span></code></pre></div></div>
<p>The workflow will not work because first we have to add Salmon to our environment.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pixi</span> add salmon</span></code></pre></div></div>
<p>Adding a container to the process and running the tool via the container is more reproducible than adding it to your environment. You can do so the following way:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">container</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'https://depot.galaxyproject.org/singularity/salmon:1.10.1--h7e5ed60_0'</span></span></code></pre></div></div>
<p>Additonally, you can also specify a process specific output directory in the process block.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">publishDir</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$params</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.outdir/salmon"</span></span></code></pre></div></div>
<p>Nextflow is big on execution abstraction. Therefore, we will specify the allocated time and cpus for this specific process in the <code>nextflow.config</code> file.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">withName:</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'INDEX'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb11-2">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">time</span> = 15.m</span>
<span id="cb11-3">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">cpus</span> = 2</span>
<span id="cb11-4"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div></div>
<p>The final version of <code>script1.nf</code> should look like this:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/usr/bin/env nextflow</span></span>
<span id="cb12-2"></span>
<span id="cb12-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params.reads</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$projectDir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/data/ggal/gut_{1,2}.fq"</span></span>
<span id="cb12-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params.transcriptome_file</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$projectDir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/data/ggal/transcriptome.fa"</span></span>
<span id="cb12-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params.multiqc</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$projectDir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/multiqc"</span></span>
<span id="cb12-6"></span>
<span id="cb12-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params.outdir</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$projectDir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/results"</span></span>
<span id="cb12-8"></span>
<span id="cb12-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">println</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reads: </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$params</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.outdir"</span></span>
<span id="cb12-10"></span>
<span id="cb12-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">process</span> INDEX {</span>
<span id="cb12-12">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input:</span></span>
<span id="cb12-13">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">path</span> transcriptome</span>
<span id="cb12-14">    </span>
<span id="cb12-15">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">container</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'https://depot.galaxyproject.org/singularity/salmon:1.10.1--h7e5ed60_0'</span></span>
<span id="cb12-16">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">publishDir</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$params</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.outdir/salmon"</span></span>
<span id="cb12-17"></span>
<span id="cb12-18">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">output:</span></span>
<span id="cb12-19">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">path</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'salmon_index'</span></span>
<span id="cb12-20"></span>
<span id="cb12-21">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">script:</span></span>
<span id="cb12-22">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb12-23"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    salmon index --threads </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$task</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.cpus -t </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$transcriptome</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> -i salmon_index</span></span>
<span id="cb12-24"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb12-25"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb12-26"></span>
<span id="cb12-27"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">workflow</span> {</span>
<span id="cb12-28">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">index_ch</span> = INDEX<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params.transcriptome_file,</span> checkIfExists: true<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">))</span></span>
<span id="cb12-29"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div></div>
<p>The <code>nextflow.config</code> file should look like this:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">process{</span></span>
<span id="cb13-2">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">executor</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"slurm"</span></span>
<span id="cb13-3">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">time</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'2.h'</span>  // Set default time limit for all processes</span>
<span id="cb13-4">    </span>
<span id="cb13-5">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">//</span> Other settings</span>
<span id="cb13-6">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">cpus</span> = 4</span>
<span id="cb13-7">        </span>
<span id="cb13-8">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">withName:</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'INDEX'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb13-9">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">time</span> = 15.m</span>
<span id="cb13-10">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">cpus</span> = 2</span>
<span id="cb13-11">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb13-12"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb13-13"></span>
<span id="cb13-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">resume</span> = true</span>
<span id="cb13-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">singularity.enabled</span> = true</span>
<span id="cb13-16"></span>
<span id="cb13-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">executor</span> {</span>
<span id="cb13-18">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">account</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span></span>
<span id="cb13-19"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div></div>
<p>Run it using the following command:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pixi</span> run nextflow run script1.nf </span></code></pre></div></div>
<p>Another option for this analysis is the following script3.nf</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/usr/bin/env nextflow</span></span>
<span id="cb15-2"></span>
<span id="cb15-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/*</span></span>
<span id="cb15-4"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">*</span> pipeline input parameters</span>
<span id="cb15-5"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">*/</span></span>
<span id="cb15-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params.reads</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$projectDir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/data/ggal/gut_{1,2}.fq"</span></span>
<span id="cb15-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params.transcriptome_file</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$projectDir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/data/ggal/transcriptome.fa"</span></span>
<span id="cb15-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params.multiqc</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$projectDir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/multiqc"</span></span>
<span id="cb15-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params.outdir</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"results"</span></span>
<span id="cb15-10"></span>
<span id="cb15-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">log.info</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb15-12"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    R N A S E Q - N F   P I P E L I N E</span></span>
<span id="cb15-13"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    ===================================</span></span>
<span id="cb15-14"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    transcriptome: </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${params</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">.transcriptome_file</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb15-15"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    reads        : </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${params</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">.reads</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb15-16"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    outdir       : </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${params</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">.outdir</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb15-17"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb15-18">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">.stripIndent()</span></span>
<span id="cb15-19"></span>
<span id="cb15-20"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">read_pairs_ch</span> = Channel.fromFilePairs<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params.reads</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb15-21"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_pairs_ch.view()</span></span></code></pre></div></div>
<p>The <code>read_pairs_ch.view()</code> command allows us to see how the read_pair_ch channel emits <code>tuples</code> composed of two elements, where the first is the read pair prefix and the second is a list representing actual files. It will print something similar to this:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[gut,</span> [/.../data/ggal/gut_1.fq, /.../data/ggal/gut_2.fq]]</span></code></pre></div></div>
<p>*Tuple: a data structure consisting of multiple parts.</p>
</section>
<section id="expression-quantification" class="level2">
<h2 class="anchored" data-anchor-id="expression-quantification"><strong>Expression quantification</strong></h2>
<p>We will add a gene expression quantification process to the script and a call to it within the workflow scope. Quantification requires the index transcriptome and RNA-seq read pair fastq files.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb17-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/usr/bin/env nextflow</span></span>
<span id="cb17-2"></span>
<span id="cb17-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/*</span></span>
<span id="cb17-4"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">*</span> pipeline input parameters</span>
<span id="cb17-5"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">*/</span></span>
<span id="cb17-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params.reads</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$projectDir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/data/ggal/gut_{1,2}.fq"</span></span>
<span id="cb17-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params.transcriptome_file</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$projectDir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/data/ggal/transcriptome.fa"</span></span>
<span id="cb17-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params.multiqc</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$projectDir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/multiqc"</span></span>
<span id="cb17-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params.outdir</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"results"</span></span>
<span id="cb17-10"></span>
<span id="cb17-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">log.info</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb17-12"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    R N A S E Q - N F   P I P E L I N E</span></span>
<span id="cb17-13"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    ===================================</span></span>
<span id="cb17-14"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    transcriptome: </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${params</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">.transcriptome_file</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb17-15"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    reads        : </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${params</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">.reads</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb17-16"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    outdir       : </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${params</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">.outdir</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb17-17"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb17-18">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">.stripIndent()</span></span>
<span id="cb17-19"></span>
<span id="cb17-20"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/*</span></span>
<span id="cb17-21"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">*</span> define the <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">INDEX</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> process that creates a binary index</span>
<span id="cb17-22"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">*</span> given the transcriptome file</span>
<span id="cb17-23"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">*/</span></span>
<span id="cb17-24"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">process</span> INDEX {</span>
<span id="cb17-25">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input:</span></span>
<span id="cb17-26">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">path</span> transcriptome</span>
<span id="cb17-27"></span>
<span id="cb17-28">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">container</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'https://depot.galaxyproject.org/singularity/salmon:1.10.1--h7e5ed60_0'</span></span>
<span id="cb17-29">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">publishDir</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$params</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.outdir/salmon_INDEX"</span></span>
<span id="cb17-30"></span>
<span id="cb17-31"></span>
<span id="cb17-32">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">output:</span></span>
<span id="cb17-33">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">path</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'salmon_index'</span></span>
<span id="cb17-34"></span>
<span id="cb17-35">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">script:</span></span>
<span id="cb17-36">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb17-37"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    salmon index --threads </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$task</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.cpus -t </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$transcriptome</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> -i salmon_index</span></span>
<span id="cb17-38"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb17-39"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb17-40"></span>
<span id="cb17-41"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">process</span> QUANTIFICATION {</span>
<span id="cb17-42">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input:</span></span>
<span id="cb17-43">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">path</span> salmon_index</span>
<span id="cb17-44">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tuple</span> val<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sample_id</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> path<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">reads</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb17-45"></span>
<span id="cb17-46">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">container</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'https://depot.galaxyproject.org/singularity/salmon:1.10.1--h7e5ed60_0'</span></span>
<span id="cb17-47">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">publishDir</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$params</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.outdir/salmon_quantification"</span></span>
<span id="cb17-48"></span>
<span id="cb17-49"></span>
<span id="cb17-50">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">output:</span></span>
<span id="cb17-51">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">path</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sample_id</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb17-52"></span>
<span id="cb17-53">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">script:</span></span>
<span id="cb17-54">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb17-55"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    salmon quant --threads </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$task</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.cpus --libType=U -i </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$salmon_index</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> -1 </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${reads</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> -2 </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${reads</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> -o </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sample_id</span></span>
<span id="cb17-56"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb17-57"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb17-58"></span>
<span id="cb17-59"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">workflow</span> {</span>
<span id="cb17-60">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Channel</span></span>
<span id="cb17-61">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">.fromFilePairs</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params.reads,</span> checkIfExists: true<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb17-62">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">.set</span> { read_pairs_ch }</span>
<span id="cb17-63"></span>
<span id="cb17-64">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">index_ch</span> = INDEX<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params.transcriptome_file</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb17-65">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">quant_ch</span> = QUANTIFICATION<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">index_ch,</span> read_pairs_ch<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb17-66">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fastqc_ch</span> = FASTQC<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">read_pairs_ch</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb17-67">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">multiqc_ch</span> = MULTIQC<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">quant_ch.mix</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fastqc_ch</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">.collect()</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb17-68"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div></div>
<p>In the workflow scope, note how the index_ch channel is assigned as output in the INDEX process.</p>
<p>Next, note that the first input channel for the quantification process is the previously declared index_ch, which contains the path to the salmon_index.</p>
<p>Also, note that the second input channel for the quantification process, is the read_pair_ch we just created. This being a tuple composed of two elements (a value: sample_id and a list of paths to the fastq reads: reads) in order to match the structure of the items emitted by the <code>fromFilePairs</code> channel factory.</p>
<p>The script can be run using:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb18-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pixi</span> run nextflow run script4.nf </span></code></pre></div></div>
<p>The same script can be executed with more read files, as shown below:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb19-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pixi</span> run nextflow run script4.nf <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--reads</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'data/ggal/*_{1,2}.fq'</span></span></code></pre></div></div>
<p>The quantification process will be executed multiple times. Nextflow parallelizes the execution of your workflow by providing multiple sets of input data to your script.</p>
<p>The process specific runtime environment definition for quantification can be added to the <code>nextflow.config</code> file, leaving the file as follow:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb20-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">process{</span></span>
<span id="cb20-2">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">executor</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"slurm"</span></span>
<span id="cb20-3">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">time</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'2.h'</span>  // Set default time limit for all processes</span>
<span id="cb20-4">    </span>
<span id="cb20-5">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">//</span> Other settings</span>
<span id="cb20-6">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">cpus</span> = 4</span>
<span id="cb20-7">        </span>
<span id="cb20-8">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">withName:</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'INDEX'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb20-9">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">time</span> = 15.m</span>
<span id="cb20-10">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">cpus</span> = 2</span>
<span id="cb20-11">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb20-12"></span>
<span id="cb20-13">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">withName:</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'QUANTIFICATION'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb20-14">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">time</span> = 10.m</span>
<span id="cb20-15">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">cpus</span> = 2</span>
<span id="cb20-16">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb20-17"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb20-18"></span>
<span id="cb20-19"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">resume</span> = true</span>
<span id="cb20-20"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">singularity.enabled</span> = true</span>
<span id="cb20-21"></span>
<span id="cb20-22"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">executor</span> {</span>
<span id="cb20-23">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">account</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span></span>
<span id="cb20-24"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div></div>
</section>
<section id="quality-control" class="level2">
<h2 class="anchored" data-anchor-id="quality-control"><strong>Quality control</strong></h2>
<p>Now we want to add another process using the FastQC to check the samples. The input is the same as the read pairs used in the quantification step.</p>
<p>In the <code>script4.nf</code> file we will have to add the following after the quantification process:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb21-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">process</span> FASTQC {</span>
<span id="cb21-2">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input:</span></span>
<span id="cb21-3">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tuple</span> val<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sample_id</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> path<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">reads</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb21-4"></span>
<span id="cb21-5">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">container</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'oras://community.wave.seqera.io/library/fastqc:0.12.1--104d26ddd9519960'</span></span>
<span id="cb21-6">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">publishDir</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$params</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.outdir/fastqc"</span></span>
<span id="cb21-7"></span>
<span id="cb21-8">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">output:</span></span>
<span id="cb21-9">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">path</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fastqc_</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sample_id</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb21-10"></span>
<span id="cb21-11">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">script:</span></span>
<span id="cb21-12">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb21-13"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    mkdir fastqc_</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_id}</span></span>
<span id="cb21-14"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    fastqc --noextract -o fastqc_</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_id}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${reads</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${reads</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> </span></span>
<span id="cb21-15"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb21-16"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span>    </span></code></pre></div></div>
<p>And the workflow needs to be updated aswell.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb22-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">workflow</span> {</span>
<span id="cb22-2">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Channel</span></span>
<span id="cb22-3">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">.fromFilePairs</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params.reads,</span> checkIfExists: true<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb22-4">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">.set</span> { read_pairs_ch }</span>
<span id="cb22-5"></span>
<span id="cb22-6">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">index_ch</span> = INDEX<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params.transcriptome_file</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb22-7">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">quant_ch</span> = QUANTIFICATION<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">index_ch,</span> read_pairs_ch<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb22-8">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fastqc_ch</span> = FASTQC<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">read_pairs_ch</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span></code></pre></div></div>
</section>
<section id="multiqc" class="level2">
<h2 class="anchored" data-anchor-id="multiqc"><strong>MultiQC</strong></h2>
<p>As a final step we will use MultiQC to generate a final report that will collect the outputs from the quantification and the FastQC processes.</p>
<p>In the <code>script4.nf</code> we will add a new process:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb23-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">process</span> MULTIQC {</span>
<span id="cb23-2">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input:</span></span>
<span id="cb23-3">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">path</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'*'</span></span>
<span id="cb23-4"></span>
<span id="cb23-5">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">container</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'community.wave.seqera.io/library/multiqc:1.31--1efbafd542a23882'</span></span>
<span id="cb23-6">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">publishDir</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$params</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.outdir/multiqc"</span></span>
<span id="cb23-7"></span>
<span id="cb23-8">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">output:</span></span>
<span id="cb23-9">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">path</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'multiqc_report.html'</span></span>
<span id="cb23-10"></span>
<span id="cb23-11">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">script:</span></span>
<span id="cb23-12">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb23-13"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    multiqc .</span></span>
<span id="cb23-14"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb23-15"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span>    </span></code></pre></div></div>
<p>And we will also have to update the workflow:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb24-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">workflow</span> {</span>
<span id="cb24-2">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Channel</span></span>
<span id="cb24-3">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">.fromFilePairs</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params.reads,</span> checkIfExists: true<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-4">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">.set</span> { read_pairs_ch }</span>
<span id="cb24-5"></span>
<span id="cb24-6">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">index_ch</span> = INDEX<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params.transcriptome_file</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-7">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">quant_ch</span> = QUANTIFICATION<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">index_ch,</span> read_pairs_ch<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-8">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fastqc_ch</span> = FASTQC<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">read_pairs_ch</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-9">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">multiqc_ch</span> = MULTIQC<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">quant_ch.mix</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fastqc_ch</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">.collect()</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb24-10"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div></div>
</section>
<section id="scripts-summary" class="level2">
<h2 class="anchored" data-anchor-id="scripts-summary"><strong>SCRIPTS SUMMARY</strong></h2>
<p>Our final <code>script4.nf</code> should look like this:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb25-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/usr/bin/env nextflow</span></span>
<span id="cb25-2"></span>
<span id="cb25-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/*</span></span>
<span id="cb25-4"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">*</span> pipeline input parameters</span>
<span id="cb25-5"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">*/</span></span>
<span id="cb25-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params.reads</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$projectDir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/data/ggal/gut_{1,2}.fq"</span></span>
<span id="cb25-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params.transcriptome_file</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$projectDir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/data/ggal/transcriptome.fa"</span></span>
<span id="cb25-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params.multiqc</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$projectDir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/multiqc"</span></span>
<span id="cb25-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params.outdir</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"results"</span></span>
<span id="cb25-10"></span>
<span id="cb25-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">log.info</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb25-12"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    R N A S E Q - N F   P I P E L I N E</span></span>
<span id="cb25-13"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    ===================================</span></span>
<span id="cb25-14"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    transcriptome: </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${params</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">.transcriptome_file</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb25-15"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    reads        : </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${params</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">.reads</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb25-16"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    outdir       : </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${params</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">.outdir</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb25-17"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb25-18">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">.stripIndent()</span></span>
<span id="cb25-19"></span>
<span id="cb25-20"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/*</span></span>
<span id="cb25-21"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">*</span> define the <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">INDEX</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> process that creates a binary index</span>
<span id="cb25-22"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">*</span> given the transcriptome file</span>
<span id="cb25-23"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">*/</span></span>
<span id="cb25-24"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">process</span> INDEX {</span>
<span id="cb25-25">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input:</span></span>
<span id="cb25-26">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">path</span> transcriptome</span>
<span id="cb25-27"></span>
<span id="cb25-28">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">container</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'https://depot.galaxyproject.org/singularity/salmon:1.10.1--h7e5ed60_0'</span></span>
<span id="cb25-29">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">publishDir</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$params</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.outdir/salmon_INDEX"</span></span>
<span id="cb25-30"></span>
<span id="cb25-31"></span>
<span id="cb25-32">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">output:</span></span>
<span id="cb25-33">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">path</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'salmon_index'</span></span>
<span id="cb25-34"></span>
<span id="cb25-35">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">script:</span></span>
<span id="cb25-36">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb25-37"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    salmon index --threads </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$task</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.cpus -t </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$transcriptome</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> -i salmon_index</span></span>
<span id="cb25-38"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb25-39"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb25-40"></span>
<span id="cb25-41"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">process</span> QUANTIFICATION {</span>
<span id="cb25-42">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input:</span></span>
<span id="cb25-43">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">path</span> salmon_index</span>
<span id="cb25-44">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tuple</span> val<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sample_id</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> path<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">reads</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb25-45"></span>
<span id="cb25-46">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">container</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'https://depot.galaxyproject.org/singularity/salmon:1.10.1--h7e5ed60_0'</span></span>
<span id="cb25-47">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">publishDir</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$params</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.outdir/salmon_quantification"</span></span>
<span id="cb25-48"></span>
<span id="cb25-49"></span>
<span id="cb25-50">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">output:</span></span>
<span id="cb25-51">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">path</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sample_id</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb25-52"></span>
<span id="cb25-53">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">script:</span></span>
<span id="cb25-54">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb25-55"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    salmon quant --threads </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$task</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.cpus --libType=U -i </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$salmon_index</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> -1 </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${reads</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> -2 </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${reads</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> -o </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sample_id</span></span>
<span id="cb25-56"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb25-57"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb25-58"></span>
<span id="cb25-59"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">process</span> FASTQC {</span>
<span id="cb25-60">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input:</span></span>
<span id="cb25-61">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">tuple</span> val<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sample_id</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> path<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">reads</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb25-62"></span>
<span id="cb25-63">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">container</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'oras://community.wave.seqera.io/library/fastqc:0.12.1--104d26ddd9519960'</span></span>
<span id="cb25-64">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">publishDir</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$params</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.outdir/fastqc"</span></span>
<span id="cb25-65"></span>
<span id="cb25-66">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">output:</span></span>
<span id="cb25-67">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">path</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fastqc_</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sample_id</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb25-68"></span>
<span id="cb25-69">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">script:</span></span>
<span id="cb25-70">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb25-71"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    mkdir fastqc_</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_id}</span></span>
<span id="cb25-72"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    fastqc --noextract -o fastqc_</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_id}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${reads</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${reads</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> </span></span>
<span id="cb25-73"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb25-74"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span>    </span>
<span id="cb25-75"></span>
<span id="cb25-76"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">process</span> MULTIQC {</span>
<span id="cb25-77">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input:</span></span>
<span id="cb25-78">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">path</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'*'</span></span>
<span id="cb25-79"></span>
<span id="cb25-80">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">container</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'community.wave.seqera.io/library/multiqc:1.31--1efbafd542a23882'</span></span>
<span id="cb25-81">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">publishDir</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$params</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.outdir/multiqc"</span></span>
<span id="cb25-82"></span>
<span id="cb25-83">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">output:</span></span>
<span id="cb25-84">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">path</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'multiqc_report.html'</span></span>
<span id="cb25-85"></span>
<span id="cb25-86">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">script:</span></span>
<span id="cb25-87">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb25-88"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    multiqc .</span></span>
<span id="cb25-89"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb25-90"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span>    </span>
<span id="cb25-91"></span>
<span id="cb25-92"></span>
<span id="cb25-93"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">workflow</span> {</span>
<span id="cb25-94">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Channel</span></span>
<span id="cb25-95">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">.fromFilePairs</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params.reads,</span> checkIfExists: true<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb25-96">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">.set</span> { read_pairs_ch }</span>
<span id="cb25-97"></span>
<span id="cb25-98">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">index_ch</span> = INDEX<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params.transcriptome_file</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb25-99">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">quant_ch</span> = QUANTIFICATION<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">index_ch,</span> read_pairs_ch<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb25-100">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fastqc_ch</span> = FASTQC<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">read_pairs_ch</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb25-101">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">multiqc_ch</span> = MULTIQC<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">quant_ch.mix</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fastqc_ch</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">.collect()</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb25-102"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div></div>
<p>And the <code>nextflow.config</code> file:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb26-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">process{</span></span>
<span id="cb26-2">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">executor</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"slurm"</span></span>
<span id="cb26-3">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">time</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'2.h'</span>  // Set default time limit for all processes</span>
<span id="cb26-4">    </span>
<span id="cb26-5">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">//</span> Other settings</span>
<span id="cb26-6">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">cpus</span> = 4</span>
<span id="cb26-7">        </span>
<span id="cb26-8">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">withName:</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'INDEX'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb26-9">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">time</span> = 15.m</span>
<span id="cb26-10">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">cpus</span> = 2</span>
<span id="cb26-11">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb26-12"></span>
<span id="cb26-13">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">withName:</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'QUANTIFICATION'</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb26-14">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">time</span> = 10.m</span>
<span id="cb26-15">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">cpus</span> = 2</span>
<span id="cb26-16">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb26-17"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb26-18"></span>
<span id="cb26-19"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">resume</span> = true</span>
<span id="cb26-20"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">singularity.enabled</span> = true</span>
<span id="cb26-21"></span>
<span id="cb26-22"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">executor</span> {</span>
<span id="cb26-23">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">account</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span></span>
<span id="cb26-24"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div></div>


</section>

 ]]></description>
  <category>info</category>
  <category>code</category>
  <guid>https://Lara-llh.github.io/MedBioInfo_blog/posts/Nextflow_RNAseq_pipeline/</guid>
  <pubDate>Thu, 09 Oct 2025 00:00:00 GMT</pubDate>
  <media:content url="https://Lara-llh.github.io/MedBioInfo_blog/posts/Nextflow_RNAseq_pipeline/dna-7094409_1280.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Nextflow Intro</title>
  <dc:creator>Lara Leal</dc:creator>
  <link>https://Lara-llh.github.io/MedBioInfo_blog/posts/Nextflow_Intro/</link>
  <description><![CDATA[ 






<p><img src="https://Lara-llh.github.io/MedBioInfo_blog/posts/Nextflow_Intro/Nextflow.png" class="post-header img-fluid"></p>
<p>Workflow managers allow you to develop an automated pipeline from your scripts that can then be run on a variety of systems.</p>
<p>The manager then coordinates the deployment of the scripts in the appropriate sequence, monitors the jobs, handles the file transfers between scripts, gathers the output, and handles re-execution of failed jobs for you. Workflow managed pipelines can run containers, which eliminates software installation and version conflicts.</p>
<p>There are two main workflow managers: <a href="https://www.snakemake.io">snakemake</a> and <a href="https://www.nextflow.io">nextflow</a>.</p>
<section id="nextflow" class="level2">
<h2 class="anchored" data-anchor-id="nextflow"><strong>Nextflow</strong></h2>
<p>In nextflow, your scripts are turned into processes, connected by channels that contain the data - input, output etc. The order of the processes, and their interaction with each other, is specfied in the workflow scope.</p>
<p><img src="https://Lara-llh.github.io/MedBioInfo_blog/posts/Nextflow_Intro/channel-process_fqc.png" class="img-fluid"></p>
<p>Important things about nextflow:</p>
<ul>
<li>The <code>script</code> can be written in any language.</li>
<li>The modularity of the process allows to re-use existing scripts and processes easily.</li>
<li>The functional processes are separated from the executive ones, therefore the pipelines are higly interoperable and portable.</li>
<li>Pipelines can be very reproducible if they are integrated with version control tools (like git or bitbucket) and container technologies (apptainer or docker).</li>
<li>They are scalable, you can start testing with just a couple of samples and easily scale up to hundreds or thusands. Processes are run in parallele automatically when possible.</li>
<li>It resumes executions. Automatically checks the processes and can resume from a point of failure without having to re-compute already completed parts.</li>
<li>Its open source.</li>
</ul>
<section id="processes-and-channels" class="level3">
<h3 class="anchored" data-anchor-id="processes-and-channels"><strong>Processes and Channels</strong></h3>
<p>The Netxflow workflows are made by combining different processes. This processes can be written in different lenguages as long as they can be executed by a Linux platform. Each process is executed independently, and different processes only comunicate via a first-in, first-out asynchronous queue. These queues are called channels, and any process can defined them as input and output. The interaction between these processes and the execution of the workflow is defined by these input output declarations.</p>
<p>This is how a basic Nextflow pipeline process block would look like:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">process</span> PROCESS_NAME{</span>
<span id="cb1-2"></span>
<span id="cb1-3">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input:</span></span>
<span id="cb1-4">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">data</span> z</span>
<span id="cb1-5">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">data</span> y</span>
<span id="cb1-6">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">data</span> x</span>
<span id="cb1-7"></span>
<span id="cb1-8">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">//</span> directives</span>
<span id="cb1-9">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">container</span></span>
<span id="cb1-10"></span>
<span id="cb1-11">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">script:</span></span>
<span id="cb1-12">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">task1</span></span>
<span id="cb1-13">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">task2</span></span>
<span id="cb1-14">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">task3</span></span>
<span id="cb1-15"></span>
<span id="cb1-16">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">output:</span></span>
<span id="cb1-17">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">output</span> x</span>
<span id="cb1-18">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">output</span> y</span>
<span id="cb1-19">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">output</span> z</span>
<span id="cb1-20"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div></div>
</section>
<section id="execution-abstraction-running-fastqc" class="level3">
<h3 class="anchored" data-anchor-id="execution-abstraction-running-fastqc"><strong>Execution abstraction running fastQC</strong></h3>
<p>In Nextflow, the process defines what comand or script is executed, and the executor determines how that script is runned. By default, the processes are excuted on the local computer. The local executor is very useful in workflow development and testing, but when running real computational workflows other platforms are required, like a high-performance computing or cloud platform.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">srun</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-A</span> project_ID <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-t</span> 15:00 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 1 fastqc <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--noextract</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> fastqc data data/sample_1.fastq.gz data/sample_2.fastq.gz </span></code></pre></div></div>
</section>
<section id="nextflow-code-example" class="level3">
<h3 class="anchored" data-anchor-id="nextflow-code-example"><strong>Nextflow code example</strong></h3>
<p>Script:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/usr/bin/env nextflow</span></span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params.greeting</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Hello world!'</span></span>
<span id="cb3-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">greeting_ch</span> = Channel.of<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">params.greeting</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb3-5"></span>
<span id="cb3-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">process</span> SPLITLETTERS {</span>
<span id="cb3-7">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input:</span></span>
<span id="cb3-8">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">val</span> x</span>
<span id="cb3-9"></span>
<span id="cb3-10">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">output:</span></span>
<span id="cb3-11">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">path</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'chunk_*'</span></span>
<span id="cb3-12"></span>
<span id="cb3-13">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">script:</span></span>
<span id="cb3-14">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb3-15"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    printf '</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$x</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">' | split -b 6 - chunk_</span></span>
<span id="cb3-16"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb3-17"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb3-18"></span>
<span id="cb3-19"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">process</span> CONVERTTOUPPER {</span>
<span id="cb3-20">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">input:</span></span>
<span id="cb3-21">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">path</span> y</span>
<span id="cb3-22"></span>
<span id="cb3-23">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">output:</span></span>
<span id="cb3-24">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">stdout</span></span>
<span id="cb3-25"></span>
<span id="cb3-26">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">script:</span></span>
<span id="cb3-27">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb3-28"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    cat </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$y</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> | tr '[a-z]' '[A-Z]' </span></span>
<span id="cb3-29"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb3-30"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb3-31"></span>
<span id="cb3-32"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">workflow</span> {</span>
<span id="cb3-33">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">letters_ch</span> = SPLITLETTERS<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">greeting_ch</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb3-34">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">results_ch</span> = CONVERTTOUPPER<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">letters_ch.flatten()</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb3-35">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">results_ch.view{</span> it }</span>
<span id="cb3-36"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div></div>
<p>To run it:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pixi</span> run nextflow run hello.nf</span></code></pre></div></div>
<p>The output:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">N</span> E X T F L O W   ~  version 25.04.7</span>
<span id="cb5-2"></span>
<span id="cb5-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Launching</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">hello.nf</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">jolly_faraday</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> DSL2 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> revision: f5e335f983</span>
<span id="cb5-4"></span>
<span id="cb5-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">executor</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>  local <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb5-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[96/fd5f07]</span> SPLITLETTERS <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span>   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[100%]</span> 1 of 1 </span>
<span id="cb5-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[7e/dad424]</span> CONVERTTOUPPER <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[100%]</span> 2 of 2 </span>
<span id="cb5-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">HELLO</span> </span>
<span id="cb5-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">WORLD!</span></span></code></pre></div></div>
</section>
<section id="modify-and-resume" class="level3">
<h3 class="anchored" data-anchor-id="modify-and-resume"><strong>Modify and resume</strong></h3>
<p>Nextflow keeps track of all the processes executed and if you modify some prts of your script, only the processes that are changed will be re-executed. In this case, it will use the cached result from the processes that werent changed.</p>
</section>
<section id="workflow-parameters" class="level3">
<h3 class="anchored" data-anchor-id="workflow-parameters"><strong>Workflow parameters</strong></h3>
<p>The workflow parameters are simply declared by prepending the prefix params to a variable name, separated by a . (e.g.&nbsp;params.greetings). Their value can be specified on the comand line:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pixi</span> run nextflow run hello.nf <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-resume</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--greeting</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Bonjour le monde!'</span></span></code></pre></div></div>
</section>
<section id="clean-up-nextflow" class="level3">
<h3 class="anchored" data-anchor-id="clean-up-nextflow"><strong>Clean up Nextflow</strong></h3>
<p>Periodically, it makes sense to clean up your nextflow working directory. You can do that manually, but the non-descriptive nature of the file system makes that difficult.</p>
<p>Nextflow keeps track of your runs that have been executed from the current directory. The folowing comand will show you the executions log and runtime information of all the runs.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pixi</span> run nextflow log</span></code></pre></div></div>
<p>You can clean the porject cache and th work directories with the folowing comand:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">nextflow</span> clean</span></code></pre></div></div>
<p>You can also specify the run or runs that you want to eliminate. <a href="https://www.nextflow.io/docs/latest/reference/cli.html#clean">Here</a> you can find a more extensive explanation of the different options.</p>


</section>
</section>

 ]]></description>
  <category>info</category>
  <guid>https://Lara-llh.github.io/MedBioInfo_blog/posts/Nextflow_Intro/</guid>
  <pubDate>Wed, 08 Oct 2025 00:00:00 GMT</pubDate>
  <media:content url="https://Lara-llh.github.io/MedBioInfo_blog/posts/Nextflow_Intro/Nextflow.png" medium="image" type="image/png" height="23" width="144"/>
</item>
<item>
  <title>Working with environments</title>
  <dc:creator>Lara Leal</dc:creator>
  <link>https://Lara-llh.github.io/MedBioInfo_blog/posts/Working-with-environments/</link>
  <description><![CDATA[ 






<p><img src="https://Lara-llh.github.io/MedBioInfo_blog/posts/Working-with-environments/pixi.webp" class="post-header img-fluid"></p>
<p>The different operating systems support different tools. In order to solve this issue, we can use environments, which wil help us make our bioinformatics work more reproducible. This environments specifiy the tools needed to perform the task and the managers inside the environment will make sure to install these tools with their dependencies so that you can run the analysis in your device.</p>
<p>There are different types of environments, like Conda, but in this course we are going to focus on Pixi.</p>
<section id="install-pixi" class="level2">
<h2 class="anchored" data-anchor-id="install-pixi">Install Pixi</h2>
<p>In order to install pixi just run the following command in your terminal:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-fsSL</span> https://pixi.sh/install.sh <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sh</span></span></code></pre></div></div>
<p>You can find more infromation about pixi <a href="https://pixi.sh/latest/installation/">here</a></p>
</section>
<section id="create-an-environment" class="level2">
<h2 class="anchored" data-anchor-id="create-an-environment">Create an environment</h2>
<p>To create an environment for your project we will ask pixi to initialize a folder named <code>pixi_training</code>. We will also add conda-forge and bioconda channles with the <code>-c</code> flag.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pixi</span> init pixi_training <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> conda-forge <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> bioconda</span></code></pre></div></div>
<p>If you look in the new folder created you find a file called <code>pixi.toml</code>.</p>
<section id="pixi.toml" class="level4">
<h4 class="anchored" data-anchor-id="pixi.toml"><strong>1. pixi.toml</strong></h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[workspace]</span></span>
<span id="cb3-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">channels</span> = [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"conda-forge"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bioconda"</span>]</span>
<span id="cb3-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">name</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"amrei_pixi_training"</span></span>
<span id="cb3-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">platforms</span> = <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"osx-arm64"</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb3-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">version</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.1.0"</span></span>
<span id="cb3-6"></span>
<span id="cb3-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[tasks]</span></span>
<span id="cb3-8"></span>
<span id="cb3-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[dependencies]</span></span></code></pre></div></div>
<p>This is how the <code>pixi.toml</code>file would like like after creating it. This file gives you information about your project:</p>
<ul>
<li>Workspace: An overview of the environment: the channels that we added when we called <code>pixi init -c</code>, the name of the environment, the operating system and the version.</li>
<li>Tasks (not covered)</li>
<li>Dependencies: it will list the different tools that you install within the environment.</li>
</ul>
</section>
<section id="pixi.lock" class="level4">
<h4 class="anchored" data-anchor-id="pixi.lock"><strong>2. pixi.lock</strong></h4>
<p>Adding a tool or a dependency to the environemnt will generate another file called <code>pixi.lock</code>.</p>
<p>This file contains information about the channels added to you environment, where the packages were dowloaded from, liceses information and more.</p>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>DO NOT DELETE <code>pixi.toml</code>or <code>pixi.lock</code> files, it will break your environment!</p>
</div>
</div>
</div>
</section>
</section>
<section id="adding-dependencies" class="level2">
<h2 class="anchored" data-anchor-id="adding-dependencies">Adding dependencies</h2>
<p>The comand <code>pixi add</code> will tell Pixi to install a specified program for you and it will be added to the dependencies list found in the <code>pixi.toml</code> file that we talked about in the previous section.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">pwd</span></span>
<span id="cb4-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> pixi_training</span>
<span id="cb4-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pixi</span> add quarto</span></code></pre></div></div>
<p>If we now check the dependencies in the <code>pixi.toml</code> file we would see the new program added <code>quarto = "&gt;=1.7.32,&lt;2"</code>(the versions might be different).</p>
</section>
<section id="running-a-package" class="level2">
<h2 class="anchored" data-anchor-id="running-a-package">Running a package</h2>
<p>In order to run a package we use the <code>run</code> command followed by the package.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pixi</span> run quarto <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--help</span></span></code></pre></div></div>
<p>You can substitute <code>quarto</code> with any other package followed by the pertinent commands.</p>


</section>

 ]]></description>
  <category>code</category>
  <guid>https://Lara-llh.github.io/MedBioInfo_blog/posts/Working-with-environments/</guid>
  <pubDate>Tue, 07 Oct 2025 00:00:00 GMT</pubDate>
  <media:content url="https://Lara-llh.github.io/MedBioInfo_blog/posts/Working-with-environments/pixi_cover.webp" medium="image" type="image/webp"/>
</item>
<item>
  <title>How to use and create containers</title>
  <dc:creator>Lara Leal</dc:creator>
  <link>https://Lara-llh.github.io/MedBioInfo_blog/posts/how-to-use-and-create-containers/</link>
  <description><![CDATA[ 






<p><img src="https://Lara-llh.github.io/MedBioInfo_blog/posts/how-to-use-and-create-containers/containers.jpg.jpg" class="post-header img-fluid"></p>
<p>Reproducibility in bioinformatics can be a big problem. The same code can be runned by you in you computer and give some results, and when given to someone else it gives other results or it doesnt fully work.</p>
<p>In order to resolve this issue, different tools were developed. You can use environments or containers.</p>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<ul>
<li><strong>Environments:</strong> they conform an isolated system that contains all the necessary software (operating system, libraries, tools, packages) needed to run the task in hand.</li>
<li><strong>Containers:</strong> they are stand-alone software pieces that specify the operating system, all dependencies and software of an isolated environment. They are built and exchanged as container images and need a container management tool to take this images and build the container. This container images are immutable and therefore stables over time.</li>
</ul>
</div>
</div>
</div>
<section id="containers" class="level2">
<h2 class="anchored" data-anchor-id="containers">CONTAINERS</h2>
<p>There are different programs taht can be use to build and run containers: <a href="https://www.docker.com">Docker</a>, <a href="https://apptainer.org">Appptainer</a> or <a href="https://podman.io">Podman</a> are the most widely used.</p>
<section id="how-to-obtain-these-containers" class="level3">
<h3 class="anchored" data-anchor-id="how-to-obtain-these-containers"><strong>1. How to obtain these containers</strong></h3>
<p>There are several repositories in which people publish container images, two of the most commonly used are: <a href="https://hub.docker.com">Dockerhub</a> and <a href="https://seqera.io/containers/">Seqera</a>.</p>
<section id="dockerhub" class="level4">
<h4 class="anchored" data-anchor-id="dockerhub">Dockerhub</h4>
<p>Once you access their webpage (no need to create an account), you can search for the software that you need. In this case we are looking for <strong>VCFtools</strong>. This software is used for VCF manipulation and querying.</p>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>VCF manipulation and querying refers to the processes of altering (manipulating) and extracting (querying) specific information from Variant Call Format (VCF) files, which are standardized text files used in bioinformatics to store and report genomic variations in sequenced samples. - Manipulation involves functions to read, write, or modify VCF data. - Querying involves selecting and formatting subsets of the data for analysis, quality control, or visualization.</p>
</div>
</div>
</div>
<p>After going to dockerhub and choosing one container, we copy the pull comand and run the following in the project server:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">apptainer</span> pull vcftools_0.1.16-1.sif docker://biocontainers/vcftools:v0.1.16-1-deb_cv1</span></code></pre></div></div>
</section>
<section id="seqera" class="level4">
<h4 class="anchored" data-anchor-id="seqera">Seqera</h4>
<p>In the case of Seqera, users dont upload their containers, but they develop container images as you request them.</p>
<p>To pull an image from this repository you need to set the container setting to Singularity (Apptainer old name).</p>
<p>Make sure the container is compiled before trying to pull it!!</p>
<p>Once its ready you can copy the text and pull it to your system with the following command:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">apptainer</span> pull vcftools_0.1.17.sif oras://community.wave.seqera.io/library/vcftools:0.1.17--b541aa8d9f9213f9</span></code></pre></div></div>
</section>
</section>
<section id="running-containers" class="level3">
<h3 class="anchored" data-anchor-id="running-containers"><strong>2. Running Containers</strong></h3>
<p>Apptainer can be used to build the container from the image. Then you can either enter the container and run as if you had the exact same operating system as the person who built it, or you can run the software inside the container from outside of the container.</p>
<section id="running-from-the-outside" class="level4">
<h4 class="anchored" data-anchor-id="running-from-the-outside">Running from the outside</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">apptainer</span> exec vcftools_0.1.17.sif vcftools <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--version</span></span></code></pre></div></div>
<p>You can use <code>run</code>or <code>exec</code> to use the container. Note than using <code>run</code>it will launch the container and first run the <code>%runscript</code> if one is defined and then run you command.</p>
</section>
<section id="running-interactively-from-the-inside" class="level4">
<h4 class="anchored" data-anchor-id="running-interactively-from-the-inside">Running interactively from the inside</h4>
<p>There is also the possibility to enter the container and work interactively within it.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">apptainer</span> shell <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>name-of-container<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span></code></pre></div></div>
<p>Remember that the container is a isolated system and if you want to use files from outside you will need to bind file paths using <code>-B</code>.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">apptainer</span> shell <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>name-of-container<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb5-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">apptainer</span> shell <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-B</span> outside/path:inside/path <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>name-of-container<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span></code></pre></div></div>
<p>To exit the container type <code>exit</code> and enter.</p>
</section>
<section id="running-containers-with-sbatch" class="level4">
<h4 class="anchored" data-anchor-id="running-containers-with-sbatch">Running containers with sbatch</h4>
<p>Apptainer containers can be run as part of a batch job if you integrate them int a SLURM job submission script.</p>
<p>We are going to add the container to our <code>FastQC</code>sbatch script.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#! /bin/bash -l</span></span>
<span id="cb6-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH -A project_ID</span></span>
<span id="cb6-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH -t 30:00</span></span>
<span id="cb6-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH -n 1</span></span>
<span id="cb6-5"></span>
<span id="cb6-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">apptainer</span> exec container_image.sif fastqc <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> . <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--noextract</span> ../data/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>fastq.gz</span></code></pre></div></div>
</section>
</section>
<section id="run-your-own-container" class="level3">
<h3 class="anchored" data-anchor-id="run-your-own-container"><strong>3. Run your own container</strong></h3>
<p>This is a computationally intesnive task. The containers are build froma definition file (<code>.def</code>extension).</p>
<p>Lets build a container with a cow telling us the date!</p>
<p>Create a file called <code>lolcow.def</code> and add the following:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Bootstrap:</span> docker</span>
<span id="cb7-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">From:</span> ubuntu:20.04</span>
<span id="cb7-3"></span>
<span id="cb7-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">%post</span></span>
<span id="cb7-5">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">apt-get</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-y</span> update</span>
<span id="cb7-6">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">apt-get</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-y</span> install cowsay lolcat fortune</span>
<span id="cb7-7"></span>
<span id="cb7-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">%environment</span></span>
<span id="cb7-9">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">LC_ALL</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>C</span>
<span id="cb7-10">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">PATH</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>/usr/games:<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$PATH</span></span>
<span id="cb7-11"></span>
<span id="cb7-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">%runscript</span></span>
<span id="cb7-13">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">date</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">cowsay</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">lolcat</span>    </span></code></pre></div></div>
<p>Then to build the conrainer use:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">apptainer</span> build lolcow.sif lolcow.def</span></code></pre></div></div>
<p>You will get information on the staus of the build and it will tell you when its ready.</p>
<p>Then you can run your new container:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">apptainer</span> run lolcow.sif</span></code></pre></div></div>
<p>If you want you can change the <code>%runscript</code>from your <code>lolcow.def</code> file and change <code>date</code>for <code>fortune</code>. Now you will get the same cow but with a tale.</p>


</section>
</section>

 ]]></description>
  <category>code</category>
  <guid>https://Lara-llh.github.io/MedBioInfo_blog/posts/how-to-use-and-create-containers/</guid>
  <pubDate>Tue, 07 Oct 2025 00:00:00 GMT</pubDate>
  <media:content url="https://Lara-llh.github.io/MedBioInfo_blog/posts/how-to-use-and-create-containers/containers.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>How to make a Quarto blog</title>
  <dc:creator>Lara Leal</dc:creator>
  <link>https://Lara-llh.github.io/MedBioInfo_blog/posts/how-to-make-a-quarto-blog/</link>
  <description><![CDATA[ 






<p><img src="https://Lara-llh.github.io/MedBioInfo_blog/posts/how-to-make-a-quarto-blog/quartoblogimage.jpg" class="post-header img-fluid"></p>
<p>In this post we are going to learn how to create a Quarto blog.</p>
<section id="part-1-create-the-blog" class="level1">
<h1><strong>Part 1: Create the blog</strong></h1>
<p>The first step is to create a Quarto blog project. In order to do so, you go to View and open the Command Palette in VScode and then type Quarto: Create Project. Select Blog project and choose the name and location in your computer.</p>
</section>
<section id="part-2-edit" class="level1">
<h1><strong>Part 2: Edit</strong></h1>
<p>Create a new post by generating a new folder in the posts folder of your Quarto blog. Inside this new folder create a new index.qmd file.</p>
<p>This file should contain some variations of the following information between two lines of :</p>
<ul>
<li>title: Title</li>
<li>author: your name</li>
<li>date: YYYY-MM-DD</li>
<li>categories: []</li>
<li>image: image.jpg</li>
</ul>
<p>After this coding information you include the content you want to have in your blog.</p>
<p>There is a lot of options for the code. Some useful resorces to explore the different alternatives that you can integrate in your code are:</p>
<ul>
<li><a href="https://quarto.org/docs/websites/website-listings.html">Listings</a></li>
<li><a href="https://quarto.org/docs/output-formats/html-code.html">Executable code</a></li>
<li><a href="https://quarto.org/docs/output-formats/html-themes.html">Themes</a></li>
<li><a href="https://quarto.org/docs/output-formats/html-lightbox-figures.html">Images formating / Lightbox figures</a></li>
</ul>
</section>
<section id="part-3-publish-your-blog" class="level1">
<h1><strong>Part 3: Publish your blog</strong></h1>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> pwd <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> you have to make sure you are working in the directory of your blog</span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> cd <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"directory"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> if you need to set the working directory</span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> init <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> to initialize the blog directory as a git repository</span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> status <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> to check </span>
<span id="cb1-8"></span>
<span id="cb1-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> remote add origin git@github.com:user/blogname.git</span>
<span id="cb1-10"></span>
<span id="cb1-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">quarto</span> render</span>
<span id="cb1-12"></span>
<span id="cb1-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">quarto</span> publish gh-pages </span></code></pre></div></div>
<section id="add-the-blog-to-github-using-github-actions" class="level3">
<h3 class="anchored" data-anchor-id="add-the-blog-to-github-using-github-actions">Add the blog to GitHub using GitHub Actions</h3>
<p>Enter your GitHub account and create a new repository</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> add <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--all</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> to add all the untracked files <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">shown</span> with the git status command<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">to</span> the repository</span>
<span id="cb2-2"></span>
<span id="cb2-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> commit <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"message to track the changes"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> to commit all the changes made</span>
<span id="cb2-4"></span>
<span id="cb2-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> push <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-u</span> origin main</span></code></pre></div></div>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>You have to follow this three steps every time you make changes in your Quarto blog and want to push them to your GitHub repository.</p>
</div>
</div>
</div>
<p>For more information on how to automate the publishing of your blog you can follow this <a href="https://quarto.org/docs/publishing/github-pages.html#github-action">Tutorial on using GitHub Actions.</a></p>


</section>
</section>

 ]]></description>
  <category>code</category>
  <guid>https://Lara-llh.github.io/MedBioInfo_blog/posts/how-to-make-a-quarto-blog/</guid>
  <pubDate>Mon, 06 Oct 2025 00:00:00 GMT</pubDate>
  <media:content url="https://Lara-llh.github.io/MedBioInfo_blog/posts/how-to-make-a-quarto-blog/quartoblogimage.jpg" medium="image" type="image/jpeg"/>
</item>
</channel>
</rss>
